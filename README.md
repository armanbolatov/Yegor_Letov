# Гражданская Оборона

Это языковая модель генерирующая текст песни по названию в стиле Егора Летова. Представляет собой трансформер [ruGPT3Large](https://github.com/ai-forever/ru-gpts) затюненый на 600+ текстах [«Гражданской Обороны»](https://www.gr-oborona.ru/).

## Структура проекта

    .
    ├───config
    │   └───params.yaml             # конфигурационные параметры
    ├───data
    │   ├───raw                     
    │   │   └───all_lyrics.xlsx     # эксель файл со всеми песнями
    │   ├───processed
    │   │   ├───train.txt           # датасет для тренировки
    │   │   └───val.txt             # датасет для валидации
    │   └───model                   # весы и параметры GPT модели
    ├───src                         
    │   ├───create_dataset.py       # создает датасет, сохраняет в processed
    │   └───scrape.py               # скрейпит текста из сайта
    ├───.gitignore
    ├───generator.py                # содержит класс с затюненой моделью
    ├───inference.py                # пример как работает предсказание
    ├───requirements.txt            # все нужные зависимости
    ├───song_lyrics.txt             # выданный моделью текст песни
    ├───song_title.txt              # заданное название песни
    ├───train.py                    # тренирует модель на обработанном датасете
    └───README.md

## Как использовать?

На устройстве должен быть питон и гит. Команды вводим с терминала.

1. Клонировать репу — ```git clone https://github.com/armanbolatov/grob```, зайти туда и поместить папку [`model`](https://disk.yandex.com/d/r84HKWAIuHI2nw) внутрь `/data`, как показано в структуре.
2. Установить все зависимости — `pip install -r requirements.txt`. 
3. Поменять название песни в `song_title.txt`.
4. Запустить предсказание — `python inference.py`. (Если на устройстве есть CUDA ядра, при создании объекта стоит поменять ключ `use_cuda=True`.)
5. Читать песенку из файла `song_lyrics.txt`